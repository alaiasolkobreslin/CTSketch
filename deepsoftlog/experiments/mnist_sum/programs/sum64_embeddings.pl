% MNIST sum:
digit(0).
digit(1).
digit(2).
digit(3).
digit(4).
digit(5).
digit(6).
digit(7).
digit(8).
digit(9).
digit(10).
digit(11).
digit(12).
digit(13).
digit(14).
digit(15).
digit(16).
digit(17).
digit(18).
digit(19).
digit(20).
digit(21).
digit(22).
digit(23).
digit(24).
digit(25).
digit(26).
digit(27).
digit(28).
digit(29).
digit(30).
digit(31).
digit(32).
digit(33).
digit(34).
digit(35).
digit(36).
digit(37).
digit(38).
digit(39).
digit(40).
digit(41).
digit(42).
digit(43).
digit(44).
digit(45).
digit(46).
digit(47).
digit(48).
digit(49).
digit(50).
digit(51).
digit(52).
digit(53).
digit(54).
digit(55).
digit(56).
digit(57).
digit(58).
digit(59).
digit(60).
digit(61).
digit(62).
digit(63).
digit(64).
digit(65).
digit(66).
digit(67).
digit(68).
digit(69).
digit(70).
digit(71).
digit(72).
digit(73).
digit(74).
digit(75).
digit(76).
digit(77).
digit(78).
digit(79).
digit(80).
digit(81).
digit(82).
digit(83).
digit(84).
digit(85).
digit(86).
digit(87).
digit(88).
digit(89).
digit(90).
digit(91).
digit(92).
digit(93).
digit(94).
digit(95).
digit(96).
digit(97).
digit(98).
digit(99).
digit(100).
digit(101).
digit(102).
digit(103).
digit(104).
digit(105).
digit(106).
digit(107).
digit(108).
digit(109).
digit(110).
digit(111).
digit(112).
digit(113).
digit(114).
digit(115).
digit(116).
digit(117).
digit(118).
digit(119).
digit(120).
digit(121).
digit(122).
digit(123).
digit(124).
digit(125).
digit(126).
digit(127).
digit(128).
digit(129).
digit(130).
digit(131).
digit(132).
digit(133).
digit(134).
digit(135).
digit(136).
digit(137).
digit(138).
digit(139).
digit(140).
digit(141).
digit(142).
digit(143).
digit(144).
digit(145).
digit(146).
digit(147).
digit(148).
digit(149).
digit(150).
digit(151).
digit(152).
digit(153).
digit(154).
digit(155).
digit(156).
digit(157).
digit(158).
digit(159).
digit(160).
digit(161).
digit(162).
digit(163).
digit(164).
digit(165).
digit(166).
digit(167).
digit(168).
digit(169).
digit(170).
digit(171).
digit(172).
digit(173).
digit(174).
digit(175).
digit(176).
digit(177).
digit(178).
digit(179).
digit(180).
digit(181).
digit(182).
digit(183).
digit(184).
digit(185).
digit(186).
digit(187).
digit(188).
digit(189).
digit(190).
digit(191).
digit(192).
digit(193).
digit(194).
digit(195).
digit(196).
digit(197).
digit(198).
digit(199).
digit(200).
digit(201).
digit(202).
digit(203).
digit(204).
digit(205).
digit(206).
digit(207).
digit(208).
digit(209).
digit(210).
digit(211).
digit(212).
digit(213).
digit(214).
digit(215).
digit(216).
digit(217).
digit(218).
digit(219).
digit(220).
digit(221).
digit(222).
digit(223).
digit(224).
digit(225).
digit(226).
digit(227).
digit(228).
digit(229).
digit(230).
digit(231).
digit(232).
digit(233).
digit(234).
digit(235).
digit(236).
digit(237).
digit(238).
digit(239).
digit(240).
digit(241).
digit(242).
digit(243).
digit(244).
digit(245).
digit(246).
digit(247).
digit(248).
digit(249).
digit(250).
digit(251).
digit(252).
digit(253).
digit(254).
digit(255).
digit(256).
digit(257).
digit(258).
digit(259).
digit(260).
digit(261).
digit(262).
digit(263).
digit(264).
digit(265).
digit(266).
digit(267).
digit(268).
digit(269).
digit(270).
digit(271).
digit(272).
digit(273).
digit(274).
digit(275).
digit(276).
digit(277).
digit(278).
digit(279).
digit(280).
digit(281).
digit(282).
digit(283).
digit(284).
digit(285).
digit(286).
digit(287).
digit(288).
digit(289).
digit(290).
digit(291).
digit(292).
digit(293).
digit(294).
digit(295).
digit(296).
digit(297).
digit(298).
digit(299).
digit(300).
digit(301).
digit(302).
digit(303).
digit(304).
digit(305).
digit(306).
digit(307).
digit(308).
digit(309).
digit(310).
digit(311).
digit(312).
digit(313).
digit(314).
digit(315).
digit(316).
digit(317).
digit(318).
digit(319).
digit(320).
digit(321).
digit(322).
digit(323).
digit(324).
digit(325).
digit(326).
digit(327).
digit(328).
digit(329).
digit(330).
digit(331).
digit(332).
digit(333).
digit(334).
digit(335).
digit(336).
digit(337).
digit(338).
digit(339).
digit(340).
digit(341).
digit(342).
digit(343).
digit(344).
digit(345).
digit(346).
digit(347).
digit(348).
digit(349).
digit(350).
digit(351).
digit(352).
digit(353).
digit(354).
digit(355).
digit(356).
digit(357).
digit(358).
digit(359).
digit(360).
digit(361).
digit(362).
digit(363).
digit(364).
digit(365).
digit(366).
digit(367).
digit(368).
digit(369).
digit(370).
digit(371).
digit(372).
digit(373).
digit(374).
digit(375).
digit(376).
digit(377).
digit(378).
digit(379).
digit(380).
digit(381).
digit(382).
digit(383).
digit(384).
digit(385).
digit(386).
digit(387).
digit(388).
digit(389).
digit(390).
digit(391).
digit(392).
digit(393).
digit(394).
digit(395).
digit(396).
digit(397).
digit(398).
digit(399).
digit(400).
digit(401).
digit(402).
digit(403).
digit(404).
digit(405).
digit(406).
digit(407).
digit(408).
digit(409).
digit(410).
digit(411).
digit(412).
digit(413).
digit(414).
digit(415).
digit(416).
digit(417).
digit(418).
digit(419).
digit(420).
digit(421).
digit(422).
digit(423).
digit(424).
digit(425).
digit(426).
digit(427).
digit(428).
digit(429).
digit(430).
digit(431).
digit(432).
digit(433).
digit(434).
digit(435).
digit(436).
digit(437).
digit(438).
digit(439).
digit(440).
digit(441).
digit(442).
digit(443).
digit(444).
digit(445).
digit(446).
digit(447).
digit(448).
digit(449).
digit(450).
digit(451).
digit(452).
digit(453).
digit(454).
digit(455).
digit(456).
digit(457).
digit(458).
digit(459).
digit(460).
digit(461).
digit(462).
digit(463).
digit(464).
digit(465).
digit(466).
digit(467).
digit(468).
digit(469).
digit(470).
digit(471).
digit(472).
digit(473).
digit(474).
digit(475).
digit(476).
digit(477).
digit(478).
digit(479).
digit(480).
digit(481).
digit(482).
digit(483).
digit(484).
digit(485).
digit(486).
digit(487).
digit(488).
digit(489).
digit(490).
digit(491).
digit(492).
digit(493).
digit(494).
digit(495).
digit(496).
digit(497).
digit(498).
digit(499).
digit(500).
digit(501).
digit(502).
digit(503).
digit(504).
digit(505).
digit(506).
digit(507).
digit(508).
digit(509).
digit(510).
digit(511).
digit(512).
digit(513).
digit(514).
digit(515).
digit(516).
digit(517).
digit(518).
digit(519).
digit(520).
digit(521).
digit(522).
digit(523).
digit(524).
digit(525).
digit(526).
digit(527).
digit(528).
digit(529).
digit(530).
digit(531).
digit(532).
digit(533).
digit(534).
digit(535).
digit(536).
digit(537).
digit(538).
digit(539).
digit(540).
digit(541).
digit(542).
digit(543).
digit(544).
digit(545).
digit(546).
digit(547).
digit(548).
digit(549).
digit(550).
digit(551).
digit(552).
digit(553).
digit(554).
digit(555).
digit(556).
digit(557).
digit(558).
digit(559).
digit(560).
digit(561).
digit(562).
digit(563).
digit(564).
digit(565).
digit(566).
digit(567).
digit(568).
digit(569).
digit(570).
digit(571).
digit(572).
digit(573).
digit(574).
digit(575).
digit(576).
digit(577).

eq(X, X).

% Addition directly on the embeddings
sum(N1, N2, N3, N4, N5, N6, N7, N8, N9, N10, N11, N12, N13, N14, N15, N16, N17, N18, N19, N20, N21, N22, N23, N24, N25, N26, N27, N28, N29, N30, N31, N32, N33, N34, N35, N36, N37, N38, N39, N40, N41, N42, N43, N44, N45, N46, N47, N48, N49, N50, N51, N52, N53, N54, N55, N56, N57, N58, N59, N60, N61, N62, N63, N64, Z) :- 
    sum_emb(N1, N2, N3, N4, N5, N6, N7, N8, N9, N10, N11, N12, N13, N14, N15, N16, N17, N18, N19, N20, N21, N22, N23, N24, N25, N26, N27, N28, N29, N30, N31, N32, N33, N34, N35, N36, N37, N38, N39, N40, N41, N42, N43, N44, N45, N46, N47, N48, N49, N50, N51, N52, N53, N54, N55, N56, N57, N58, N59, N60, N61, N62, N63, N64, Z).

% Add two lists of embeddings (input1, input2, result)
sum_emb([], [], []).
sum_emb([~H1], [~H2], [~H3], [~H4], [~H5], [~H6], [~H7], [~H8], [~H9], [~H10], [~H11], [~H12], [~H13], [~H14], [~H15], [~H16], [~H17], [~H18], [~H19], [~H20], [~H21], [~H22], [~H23], [~H24], [~H25], [~H26], [~H27], [~H28], [~H29], [~H30], [~H31], [~H32], [~H33], [~H34], [~H35], [~H36], [~H37], [~H38], [~H39], [~H40], [~H41], [~H42], [~H43], [~H44], [~H45], [~H46], [~H47], [~H48], [~H49], [~H50], [~H51], [~H52], [~H53], [~H54], [~H55], [~H56], [~H57], [~H58], [~H59], [~H60], [~H61], [~H62], [~H63], [~H64], [HZ]) :-
    digit(HZ),
    eq(~HZ, ~plus64(H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20, H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40, H41, H42, H43, H44, H45, H46, H47, H48, H49, H50, H51, H52, H53, H54, H55, H56, H57, H58, H59, H60, H61, H62, H63, H64)).


% for digit eval:
mnist(X, N) :- digit(N), eq(X, ~N).